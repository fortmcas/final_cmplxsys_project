Introduction

As the world becomes increasingly dependent on the interconnectedness of the internet, the threat of intrusion becomes more and more present.  Every newly architected system or feature that we use and incorporate in our daily life has vulnerabilities, liable to exploitation by bad actors, adversarial governments, criminal organizations, and more.  As such, the demand for both IDS (intrusion detection system) and NDR (network threat detection and response) systems is at an all time high.  Many startups such as Vectra, Darktrace, and Cylance are using machine learning to identify anomalous behavior in a network and offer visibility into zero-day attacks.  Inspired by these methods and businesses, this project will focus on the use of critical network statistics to identify attack behaviors using neuroevolutionary techniques.  

Literature Survey and Prior Work

There are many existing methods for intrusion detection and identification of particular attacks.  Han and Cho investigated the use of neural networks, statistics, rule learning, and Hidden Markov Models (HMMs) for use in intrusion detection systems and found evolution of neural networks to be a promising method, given its ability to “discover the structures and weights…simultaneously” [1].  An important consideration to make is the scope of the training set and the goal of the algorithm itself.   Upon review of several patents by Vectra AI, it appears that industry in this space is using both high-level detections and low-level detections.  That is to say, the detection system is simultaneously watching for high-level anomalies [2], as well as specific types of threats like Botnet attacks [3].  Both of these methods rely on a patented system of host and user identification across sessions [4] and time series data capture and playback [5].  No matter the approach taken, selecting the right training dataset is of vital importance to the success of the generated model when applied to unseen data.  Sharafaldin, Lashkari, and Ghorbani of the Canadian Institute for Cybersecurity created an IDS dataset for public use, which will form the foundation of the training data used in this project, offering over a dozen different attack behaviors as well as additional network data from a benign agent [6].

Dataset and Data Reduction Techniques

The aforementioned dataset from the Canadian Institute for Cybersecurity was selected for this project due to its versatility in both attack type signatures offered, and scope of data collected.  The dataset includes Windows and Linux event logs, PCAPs (raw network packet data), and over 80 traffic features extracted using CIC’s own flowmeter, CICFlowMeter-V3 [7,8].  Due to the limited timeframe of this project, the timeseries approaches taken by Vectra and other NDR vendors described earlier will be too prohibitively time-consuming to implement.  As a result, the extracted traffic features will be used to paint a picture of the characteristics of the attack over the long-term.  While this method eliminates the ability to detect attacks in real-time, it could theoretically be used to detect intrusion events shortly after they occur.  As mentioned earlier, the dataset includes over 80 extracted features for each network communication, including flow duration, total packets in forward and backward directions, and many more.  In order to reduce the amount of data fed into the neural network, each of these features’ values were summed over the entire duration of the attack, and then divided by the flow duration, in order to properly scale each attack since each attack type takes a differing amount of time to complete.  The resulting lists of time-scaled characteristics were then pickled in Python so each could be accessed easily and efficiently during the learning and evaluation processes.

Attack Type Background

This project will use the following types of attacks as training data for the neural network in question, each of which is defined below.
Bot:  A bot is an automated software tool, which when used in attacks sends automated web requests in order to disrupt its target, which can include websites, applications, APIs, and more.  [9]
Brute Force: Brute force attacks involve attempting to obtain the correct password or hash to a given service, server, or other internet entity using simple brute force.  The data this project will use involves multiple applications of brute force attacks, including XSS (cross-site scripting), FTP (file transfer protocol), and SSH (secure shell protocol). [10]
DoS (Denial of Service):  A DoS attack is meant to shut down a machine or network completely by flooding it with traffic, meaning that legitimate users cannot access the resources they desire.  Several tools for testing whether sites are susceptible to DoS attacks are available, data from which are included in the dataset being used, including GoldenEye, Slowloris, and Hulk.  [11]
Infiltration: In the case of this dataset, infiltration is an inside-out approach to gaining access to a network.  This can be done using malware, phishing, or any other method that would allow a user to unintentionally run code that creates a backdoor in the network, allowing for infiltration and eventual privilege escalation. [7]
SQL Injection: SQL injection is a code injection technique that exploits vulnerabilities in incorrect or insufficient string filtering to execute SQL commands through API endpoints or other data input vectors [12].

Training the Network

A simple neuroevolutionary code base was implemented in Python, based on work done in Lab 5.2, which allows easy creation of populations of neural networks which can be selected, reproduced, and mutated, to evolve an optimal network for detecting attacks.  A broad approach was taken, simply attempting to classify the reduced data as being part of an attack (represented as a binary output 1), or as benign traffic (represented as a binary output 0).  Each of the networks created was tested and evolved against correct recognition of the traffic type as the fitness function.  The training set used on the network consisted three groups of benign traffic, two DoS attacks, one infiltration attack, one SQL injection attack, and one brute force attack.  The network was evolved until it was able to categorize each of the signatures correctly as either benign traffic or an attack.
Evaluating Success of the Evolved Network
In order to evaluate the success of the evolved network, it must categorize never-before-seen data sets correctly.  The fitness of the evolved network was evaluated against two new benign traffic sets, one new DoS set, one new infiltration set, one new SQL injection set, one new brute force set, and importantly, a new type of attack the network had never seen before: bot.  Not only was the evolved network able to classify each of the new sets of previously seen types of attacks correctly, but it correctly recognized the bot traffic as being malicious.

Conclusion

Using neuroevolution seems extremely promising as a method of creating neural networks to identify network intrusion, both from past research conducted and the results of this project.  The trained network was able to identify new types of attacks as malicious, albeit with a small sample size, constrained by the available data set.  With a larger training data set, and time-series implementation, this technique could prove successful in larger applications.  Another useful experiment could be to implement NEAT or HyperNEAT methods to dynamically scale the size and shape of the neural network based on performance, which could help determine the smallest feasible network size that still performs correctly, which could be extremely useful when trying to speed up runtime of the network when evaluating high throughput timeseries data.

References

[1] Han SJ, Cho SB. Evolutionary neural networks for anomaly detection based on the behavior of a program. IEEE Trans Syst Man Cybern B Cybern. 2006 Jun;36(3):559-70. doi: 10.1109/tsmcb.2005.860136. PMID: 16761810.
[2] Pegna D.L, Mhatre H., Brdiczka, O., Vectra AI Inc., System for implementing threat detection using daily network traffic community outliers, US10033752B2
[3] Beauchesne N., Vectra AI Inc., Method and system for detecting bot behavior, US9930053B2
[4] Ibatullin O., Prenger R.J., Beauchesne N., Lynn K.M., Tavakoli O.K., Vectra AI Inc., System and method for detecting network intrusions using layered host scoring, US9565208B2
[5] Harlacher J., Abene M., Vectra Networks Inc., Systems and methods for capturing, replaying, or analyzing time-series data, US9237164B2
[6] Sharafaldin, I., Lashkari, A. H., and Ghorbani, A. A., “Toward Generating a New Intrusion Detection Dataset and Intrusion Traffic Characterization” Available: https://www.scitepress.org/Papers/2018/66398/66398.pdf.
[7] “CSE-CIC-IDS2018 on AWS,” Canadian Institute for Cybersecurity Available: https://www.unb.ca/cic/datasets/ids-2018.html. 
[8] “A Realistic Cyber Defense Dataset (CSE-CIC-IDS2018),” Registry of Open Data on AWS Available: https://registry.opendata.aws/cse-cic-ids2018/. 
[9] “What Are Bot Attacks? Bot Mitigation for Web Apps & APIs,” Signal Sciences Available: https://www.signalsciences.com/glossary/bot-attack-protection/. 
[10] “Brute-force attack,” Wikipedia Available: https://en.wikipedia.org/wiki/Brute-force_attack. 
[11]  “What is a denial of service attack (DoS) ?,” Palo Alto Networks Available: https://www.paloaltonetworks.com/cyberpedia/what-is-a-denial-of-service-attack-dos.
[12] “SQL injection,” Wikipedia Available: https://en.wikipedia.org/wiki/SQL_injection.
